import requests

# Function to download file from SharePoint
def download_file_from_sharepoint(site_url, file_path, username, password, output_path):
    # SharePoint REST API endpoint for file content
    api_url = f"{site_url}/_api/web/GetFileByServerRelativeUrl('{file_path}')/$value"
    
    # Authentication headers
    headers = {
        "Accept": "application/json;odata=verbose"
    }
    
    # Make request to SharePoint
    response = requests.get(api_url, auth=(username, password), headers=headers)
    
    # Check if request was successful
    if response.status_code == 200:
        # Write file content to output path
        with open(output_path, 'wb') as f:
            f.write(response.content)
        print("File downloaded successfully.")
    else:
        print("Failed to download file.")

# Example usage
site_url = "https://your-sharepoint-site-url"
file_path = "/sites/your-site/Documents/Example.docx"
username = "your_username"
password = "your_password"
output_path = "downloaded_file.docx"

download_file_from_sharepoint(site_url, file_path, username, password, output_path)
