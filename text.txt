$imagePath = "C:\path\to\your\image.jpg"

# Get WMI object for the image
$wmiObject = Get-WmiObject -Class Win32_SystemFile -Filter "Path='$imagePath'"

# Extract properties
$properties = @{
  "Width" = $wmiObject.DriveBytes
  "Height" = $wmiObject.FileSize
  "Color Depth" = ($wmiObject.FileSize / ($wmiObject.Width * $wmiObject.Height)) * 8
}

# Display properties with error handling (admin rights needed)
try {
  $properties | Format-Table -Property Name, Value
} catch {
  Write-Error "Error retrieving image properties. Run script with Administrator privileges."
}
